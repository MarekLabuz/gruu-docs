const Gruu=function(){const e=e=>null!=e&&!1!==e;let t=1;const n=()=>t+=1,r=e=>e[e.length-1],i=e=>e&&e.noProxy||e,c=(e,t)=>t.reduce((e,t)=>e[t],e),s=e=>e._n?e:s(e._parent),o=(e,t=(()=>null))=>e.noProxy?e:t.bind(new Proxy(e,g(e))),_=(e,t)=>{for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},l=t=>{const n=i(t);return e(n)&&"object"!=typeof n?{_type:"text",textContent:n}:n},d=e=>{let t=e.length-1;for(;t>=0&&!e[t];)e.splice(t,1),t-=1},a=(e,t)=>{e._r&&e._w&&(e._id=e._id||n(),Object.keys(e._w).forEach(n=>{if(t){const r=e._w[n]._l[e._id].keys;r.forEach(e=>{const n=e.split("->")[1].trim();t.includes(n)&&r.delete(e)}),0===r.size&&(delete e._w[n]._l[e._id],delete e._w[n])}else delete e._w[n]._l[e._id],delete e._w[n]}))},h=(e,t,n)=>{if(t.startsWith("$")){const r=t.slice(1);$.push({component:e,key:t});const i=o(e,n||e[t])();$.pop();const c=e[r],s=b(i,c,e,[r]);e[r]=s}},f=(e,t)=>{if(t.startsWith("$")){const n=t.slice(1);$.push({component:e,key:t});const r=o(e,e[t])(),i=Array.isArray(r)||"$children"!==t?r:[r];e[n]="children"===n?i.map(l):i,$.pop()}},u=(e,t,n,i,c)=>{const o=O(e,c);o._parent=c,e=o;const _=W(o),l=s(n);if((l===n||1===l.children.length&&l.children[0]===n)&&parseInt(i,10)>n.children.length-1)_.forEach(({node:e})=>{e&&l._n.appendChild(e)});else{n.children[i]=o;const e=W(l,!0);n.children[i]=t;const c=r(_);if(c){const t=e.findIndex(({id:e})=>e===c.id),n=-1!==t?e.slice(t+1).find(e=>e&&e.node&&e.node.parentNode):null;_.forEach(({node:e})=>{e&&l._n.insertBefore(e,n&&n.node)})}}return t&&t._unmount(),e},p=(t,n,r,c,s)=>{const h=c[1];if(void 0===h){r.children||(r.children=[]),t=(Array.isArray(t)?t:[t]).map(l);const e=n.length-t.length,i=t.concat(Array(e<0?0:e));for(let e=0;e<i.length;){const c=n[e],o=i[e];!(t.length>=n.length)&&c&&o&&c._key&&o._key&&c._key!==o._key?(c._unmount(),n=[...n.slice(0,e),...n.slice(e+1)]):(t[e]=b(o,c,r,["children",`${e}`],{dest:m,parent:s}),e+=1)}d(t)}else if(!isNaN(parseInt(h,10)))if(n===t||n&&t&&(n._createdBy||t._createdBy)&&_(n._createdBy,t._createdBy))t=n;else{const c=e(n),_=e(t);if(c&&!_)n._unmount();else if(c&&_)if(a(n),!n._type&&!t._type||n._type&&t._type&&n._type===t._type||"text"===n._type&&"object"!=typeof t){const e=l(t);e._parent=s,e.children&&Array.isArray(e.children)&&(e.children=e.children.map(i));const r={$:[],other:[]};Object.keys(Object.assign({},n,e)).forEach(t=>{n[t]!==e[t]&&(t.startsWith("$")?(r.$.push(t),r.other.push(t.slice(1))):t.startsWith("_")?["_createdBy","_key","_parent"].includes(t)||(e[t]=n[t]):r.other.push(t))}),r.$.forEach(t=>{f(e,t)}),r.other.forEach(t=>{"function"==typeof e[t]&&(e[t]=o(e,e[t])),e[t]=b(e[t],n[t],n,[t],{parent:e})}),t=e}else t=u(t,n,r,h,s);else!c&&_&&(t=u(t,n,r,h,s))}return t},y=(e,t,n,i)=>{if(null==n){const n=t[0];e._n[n]="",e._n.removeAttribute&&e._n.removeAttribute(n)}else if(n&&"object"==typeof n){const r=t[0],c=Object.assign({},i,n);e._n&&Object.keys(c).forEach(t=>{i&&i[t]===n[t]||(e._n[r][t]=n[t]||"")})}else e._n&&i!==n&&(c(e._n,t.slice(0,-1))[r(t)]=n);return n},m=2,k=(e=[])=>{let t="",n=!0;for(const r of e){if(0===t||r.startsWith("$"))return 0;if(1===t||"state"===r&&n)return 1;"children"===r&&n?(t=m,n=!1):t!==m||isNaN(parseInt(r,10))?n&&(t=3,n=!0):(t=m,n=!0)}return t},b=(e,t,n,r,{dest:c,parent:s=n}={})=>{const o=c||k(r),_=i(n),l=i(e);switch(o){case m:return p(l,t,_,r,s);case 3:return y(_,r,l,t);default:return e}},E=(e,t,c,s)=>{if("noProxy"===s)return c;if("string"==typeof s&&s.startsWith("_"))return c[s];const{component:o,key:_}=r($)||{};if(o){const r=i(e),c=i(o);r._l||(r._l={});const l=[...t,s].join(".");c._id=c._id||n(),r._l[c._id]||(r._l[c._id]={keys:new Set}),r._l[c._id].component=c,r._l[c._id].keys.add(`${l} -> ${_}`),c._w||(c._w={}),r._id=r._id||n(),c._w[r._id]=r}const l=c[s]&&(c[s]._type||c[s].children),d=l?c[s]:e;return c[s]&&"object"==typeof c[s]?new Proxy(i(c[s]),g(d,...l?[]:[...t,s])):"function"==typeof c[s]?c[s].bind(c):c[s]},j=(e,t)=>{let n=e,r=e,i=0,c=3;for(let e=0;e<t.length;e+=1){const s=t[e];if(n=n[s],3===c&&s===m)c=m;else{if(3===c&&1===s)return{c:r,i:e};c!==m||isNaN(parseInt(s,10))||(r=n,i=e,c=3)}}return{c:r,i:i}},w=(e,t,n,r,c)=>{const s=[...t,r],{c:o,i:_}=j(e,s),l=n[r],d=i(c),f=b(d,l,o,s.slice(_));return n[r]=f,e._actionsToUpdate=[...e._actionsToUpdate||[],s.join(".")],clearTimeout(e._rerender),e._rerender=setTimeout(()=>{const t=e._actionsToUpdate;e._actionsToUpdate=[],e._l&&Object.keys(e._l).forEach(n=>{if(e._l[n]){const{component:r,keys:i}=e._l[n],c=Object.keys(r).reduce((e,n)=>[...e.filter(e=>e!==n),...n.startsWith("$")&&t.some(e=>i.has(`${e} -> ${n.split(".")[0]}`))?[n]:[]],[]);a(r,c),c.forEach(e=>{h(r,e)})}})}),!0},g=(e,...t)=>({get:(n,r)=>E(e,t,n,r),set:(n,r,i)=>w(e,t,n,r,i)}),A=e=>{const t=document.createElement(e._type);return Object.keys(e).forEach(n=>{if(!n.startsWith("_")&&!n.startsWith("$"))switch(n){case"style":Object.keys(e[n]).forEach(r=>{t.style[r]=e[n][r]});break;case"children":case"state":return;default:t[n]=e[n]}}),t},$=[],x=e=>{const t=i(e);return t._r?t:(Object.keys(t).forEach(e=>{"function"!=typeof t[e]||e.startsWith("$")||(t[e]=o(t,t[e])),f(t,e)}),t.children&&Array.isArray(t.children)&&(t.children=t.children.map(i)),t._unmount=function(){if(a(this),this._r)if(this._n){const e=s(this._parent);this._n.parentNode&&e._n.removeChild(this._n)}else this.children&&this.children.forEach(e=>{e&&e._unmount()})},t)},O=(t,n,r)=>{const i=l(t);if(!e(i))return i;i._r&&Object.keys(i).forEach(e=>{h(i,e)});const c=x(i);return T(c,n,r),e(c.children)&&!c._r&&(Array.isArray(c.children)||(c.children=[c.children]),c.children=c.children.map(e=>O(e,c,c._n?c:r))),c._r=!0,c},N=t=>{const n=l(t);return e(n)?new Proxy(n,g(n)):n},T=(e,t,n)=>{const r=i(e);r&&(r._type&&(r._n=r._n||("text"===r._type?document.createTextNode(r.textContent):A(r))),r._parent=i(t),n&&r._n&&n._n.appendChild(r._n))},W=(t,r)=>{const c=i(t);if(e(c)){if(c._id=c._id||n(),c._n&&!r)return[{id:c._id,node:c._n}];if(c.children)return c.children.reduce((e,t)=>e.concat(t?W(t):[{id:c._id}]),[])}return[]};return Object.assign({createComponent:N,renderApp:(e,t)=>{const n=i(N({children:t})),r={_n:e,children:[n]};O(n,r,r)}},window.__DEV__?{destinations:{DEFAULT:0,STATE:1,CHILDREN:m,NODE:3},findDestination:k}:{})}();"undefined"!=typeof module&&(module.exports=Gruu);